# Function 'gensimdata.m'
This is the main function to use for generating simulation data files.
## How to use
The input arguments for **gensimdata.m** are: The path to a .mat **input_parameter_file** containing the variables listed below, the path to a .mat **pulsar_catalog_file** containing information about the pulsars in the PTA, and the **output_folder** name where the data realizations will be stored.

### Variables required in the input_parameter_file
Use the Function **parameters.m** to generate the input_parameter_file.
This function will generate a parameter file contains random GW sources, number of pulsars in the timing array, starting epoch of the observation, the information of noises and the searching range for PSO.

**Note**: Though these variables are already in the input_parameter_fil but will still be individually stored in a file **searchParams_simDataSKA_X.mat** for the future use of multiple sources.

The input arguments are listed below:

**NumGwsources**

```matlab
number of GW sources.
```

**NumPulsar**

```matlab
number of pulsars.
```

**NumNoiseReali**

```matlab
number of noise realizations H1
```

**NumRealiNoise**

```matlab
number of realization of noise only cases H0
```

### Variables required pulsar_catalog_file
This file is an example pulsar catalog called **survey_ska.mat** contains the information of pulsars.

### Inputs needed
1. input_parameter_file, generated by the function **parameters.m**

2. Pulsar catalog: skamsp=load('/path/to/the/file/survey_ska.mat');

3. output_folder: name of the folder where the data realization will be stored.

4. Subfunctions called:

* GenerateRandomGWSource, SpherePointPicking: generates a random realization of Ns SMBHBs with parameters, such as chirp mass (Mc), location (alpha, delta), distance (r), GW frequency (fgw), angles (iota, Psi, Phi0), sampled either uniformly or log uniformly. These parameters are saved in H1 data file. The parameter values are set to 0 for H0 data.

* coco, cosine, rotm_coo: coordinates transformation

* likelihood, InnProduct,LLR_PSOmpp, etc:  calculating the time series of timing residual and the likelihood.

### Example
See **test_gensimdata.m** for a worked out example of how to generate simulated data files.
