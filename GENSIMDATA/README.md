This folder contains the code for generating simulated Pulsar Timing Array (PTA) data. The data from a PTA is a collection of the timing residuals from Np pulsars. The code generates statistically independent realizations of PTA data and stores them in files.

The main code is **gensimdata.m**, which generates data realizations of two types, namely,  signal+noise ('H1 data')   and noise-only ('H0 data'). The name of the file containing a data realization indicates what type of data it is. For example, 'GWBsimDataSKASrlz1Nrlz1.mat' contains H1 data while  'noise1.mat' contains H0 data. In each file, the timing residuals for all the pulsars are generated with the same start and end times, and the same sampling rate. Each data file may take 20 sec or so to generate on a single processor (2.8 GHz Intel Core i7).

The noise in each timing residual is assumed to consist of only radiometer and jitter noise, which is well approximated as Gaussian white noise, because these are expected to be the dominant sources of noise for timing residuals obtained with the Square Kilometer Array (SKA). At present, the noise standard deviation (sd) is assumed to be 100 nano-seconds (ns) for each pulsar. The GW signal in each timing residual arises from a set of Ns Supermassive Black Hole Binaries (SMBHBs) scattered across the Universe. (Currently, Ns=100 in the codes.)

The simulated data files are stored in an output_folder. Its contents are organized as follows.

(1) The file GWB_Srlz1.mat contains information about the particular simulation. This info may have some overlap with that cointained in the H1/H0 data files for ease of subsequent analysis. 

(2) H1 data files (e.g., GWBsimDataSKASrlz1Nrlz1.mat).


(3) H0 data files (e.g., noise1.mat). We try to maintain the same variable names for the contents in H0 and H1 data files.

[All of the following should be moved into the user guide for gensimdata.m because they are describing the input/output arguments of that function.]
In the home folder [What is the "home folder"?], search parameter file (generated by the function **parameters.m**) contains a two column matrix 'xmaxmin' which provides the maximum and minimum values of the search range for each parameter (parameter ranges). The detection algorithm 'MaxPhase' and 'AvPhase' (in C) may use a different parameter file which separate the full range into several bins for the purpose of multiple source detection and estimation.


Inputs needed:

(1) Pulsar catalog: skamsp=load('/path/to/the/file/survey_ska.mat');

(2) Subfunctions called:

* GenerateRandomGWSource, SpherePointPicking: generates a random realization of Ns SMBHBs with parameters, such as chirp mass (Mc), location (alpha, delta), distance (r), GW frequency (fgw), angles (iota, Psi, Phi0), sampled either uniformly or log uniformly. These parameters are saved in H1 data file. The parameter values are set to 0 for H0 data.

* coco, cosine, rotm_coo: coordinates transformation

* [Check that these functions are indeed called by gensimdata.m or not. I don't think LLR_PSO is called.] likelihood, InnProduct,LLR_PSO, etc:  calculating the time series of timing residual and the likelihood.

**Note**: simulator_skaNano.m is an earlier version of the code, which is not used in the current simulation.

Example and more information

you can find an example and more information about the functions at
[user-guide](https://github.com/yanwang2012/RAAPTR/blob/master/GENSIMDATA/gensimdata_Guide.md)


